<head>
  <title>brasil2014bet</title>
</head>

<body>
  <div class="container-fluid">
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">WM 2014 Tippspiel</a>
        </div>

        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="{{#unless rankingSiteActive}}active{{/unless}}"><a id="betSiteNav">Tipps</a></li>
            <li class="{{rankingSiteActive}}"><a id="rankingSiteNav">Ranking</a></li>
            <li><a href="#">
              {{#if currentUser}}
                {{> loginButtons}}
              {{else}}
                <label>Benutzer:</label>
                <input type="text" id="username"/>
                <label>Passwort:</label>
                <input type="text" id="password"/>
                <button class="btn btn-sm" id="loginUser">Login</button>
              {{/if}}
            </a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div>
    </nav>
    <br><br><br>
    <div class="container-fluid">
      {{#unless rankingSiteActive}}
        {{#each matchTypes}}
          <h4>{{this}}</h4>

          <table class="table">
            <thead>
              <tr>
                <th style="width: 15%;">Team 1</th>
                <th style="width: 15%;">Team 2</th>
                <th style="width: 20%;">Start</th>
                <th style="width: 10%;">Ergebnis</th>
                {{#if currentUser}}
                  <th style="width: 40%;">Mein Tipp</th>
                {{/if}}
              </tr>
            </thead>
            <tbody>
              {{#each matchesByType}}
                {{#if isFixed}}
                  <tr>
                    <td>{{team1}}</td>
                    <td>{{team2}}</td>
                    <td>{{start}}<br>{{remainingTime}}</td>
                    <td>{{#if result}}{{result}}{{else}}n/a{{/if}}
                      {{#if isFinals}}
                        {{#if result_overtime}}
                          <br>
                          n.V. {{result_overtime}}
                        {{/if}}
                        {{#if result_eleven}}
                          <br>
                          n.E. {{result_eleven}}
                        {{/if}}
                      {{/if}}
                    </td>
                    {{#if currentUser}}
                      <td>{{> myBet}}</td>
                    {{/if}}
                  </tr>
                {{/if}}
              {{/each}}
            </tbody>
          </table>
        {{/each}}
      {{else}}
        <ol>
          {{#each rankings}}
            <li><strong>{{user}}</strong> mit <strong>{{points}}</strong> Punkten</li>
          {{/each}}
        </ol>
      {{/unless}}
    </div>
  </div>
</body>

<template name="myBet">
  {{#unless currentBet}}
    {{#unless timeIsUp}}
      <button class="btn btn-sm btn-primary" data-toggle="modal" data-target="#{{_id}}">Tipp abgeben</button>
    {{else}}
      <strong>Zeit abgelaufen!</strong>
    {{/unless}}
  {{else}}
    {{#with currentBet}}
      <div>
        {{result}}
        {{#if ../isFinals}}
          {{#if result_overtime}}
            <br>
            n.V. {{result_overtime}}
          {{/if}}
          {{#if result_eleven}}
            <br>
            n.E. {{result_eleven}}
          {{/if}}
        {{/if}}

        {{#unless ../timeIsUp}}
          <button type="button" class="btn btn-sm btn-danger remove-bet">
            <span class="glyphicon glyphicon-remove"></span>
          </button>
        {{else}}
          <strong>{{myPoints}}</strong>
        {{/unless}}
      </div>
    {{/with}}
  {{/unless}}

  <div class="modal fade" id="{{_id}}" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h4 class="modal-title" id="mySmallModalLabel">Tipp abgeben</h4>
        </div>

        <div class="modal-body">
          <h4>Reguläre Spielzeit:</h4>
          <input type="text" class="bet-team1" style="width: 20%;"/>
          <strong>:</strong>
          <input type="text" class="bet-team2" style="width: 20%;">

          <br>

          {{#if isFinals}}
            <h4>Nach Verlängerung:</h4>
            <input type="text" class="bet-team1-overtime" style="width: 20%;"/>
            <strong>:</strong>
            <input type="text" class="bet-team2-overtime" style="width: 20%;">

            <br>

            <h4>Nach Elfmeterschießen:</h4>
            <input type="text" class="bet-team1-eleven" style="width: 20%;"/>
            <strong>:</strong>
            <input type="text" class="bet-team2-eleven" style="width: 20%;">
          {{/if}}

          <button type="button" class="btn apply-bet">
            <span class="glyphicon glyphicon-ok"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
</template>
